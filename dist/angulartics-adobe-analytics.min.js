!function(window,angular){"use strict";function stripTags(properties,analyticsLabel){properties[analyticsLabel]=properties[analyticsLabel].replace(/(<([^>]+)>)/gi,"").replace(/\n/g,"").replace(/\s{2,}/g," ").trim()}var buffer=[];angular.module("angulartics.adobe.analytics",["angulartics"]).config(["$analyticsProvider",function($analyticsProvider){$analyticsProvider.settings.pageTracking.trackRelativePath=!0,$analyticsProvider.settings.adobeA={properties:{eventClass:{},global:{},page:{}}},$analyticsProvider.registerPageTrack(function(path){var event={pageName:path};angular.extend(event,$analyticsProvider.settings.adobeA.properties.global,$analyticsProvider.settings.adobeA.properties.page);for(var key in event){var match=key.match(/prop(\d+)/);match&&!event["eVar"+match[1]]&&(event["eVar"+match[1]]=event[key])}window.s&&window.s.t(event)}),$analyticsProvider.registerEventTrack(function(eventType,properties){var buffered=!1;window.s&&eventType&&this.$inject(["$interval",function($interval){properties=properties||{};var events,eventLabel=eventType,adobeAprops=$analyticsProvider.settings.adobeA.properties,eventConfig=angular.extend({},adobeAprops.eventMap,adobeAprops.eventClass[eventType]),props={},linkTrackVars=[],linkTrackIgnore=["account","events","linkTrackEvents","context"];eventConfig&&(eventConfig.eventLabel&&(eventLabel=eventConfig.eventLabel),events=properties.eventIds||eventConfig.eventIds,events&&(properties.events=events,properties.linkTrackEvents=events,linkTrackVars.unshift("events"),delete properties.eventIds),angular.forEach(eventConfig,function(adobeLabel,analyticsLabel){if(angular.isDefined(properties[analyticsLabel])){stripTags(properties,analyticsLabel);var found=adobeLabel.match(/eVar(\d+)/);found&&(properties["prop"+found[1]]=properties[analyticsLabel]),properties[adobeLabel]=properties[analyticsLabel],delete properties[analyticsLabel]}})),delete properties.eventType,angular.extend(props,adobeAprops.global,properties),props.context&&(props.contextData||(props.contextData={}),angular.isDefined(props.value)?props.contextData[eventLabel]=props.value:props.contextData[eventLabel]=1,linkTrackVars.push("contextData."+eventLabel),delete props.context,props.buffered===!1?delete props.buffered:buffered=!0),linkTrackVars=linkTrackVars.concat(Object.keys(props).filter(function(obKey){return linkTrackIgnore.indexOf(obKey)===-1})),props.linkTrackVars=linkTrackVars.join(",");var linkType="o";"DOWNLOAD"===eventLabel.toUpperCase()?linkType="d":"EXIT"===eventLabel.toUpperCase()&&(linkType="e"),buffered?(buffer.push(props),buffer.timeout&&$interval.cancel(buffer.timeout),buffer.timeout=$interval(function(){var bufferedProps={account:buffer[0].account,contextData:{},linkTrackVars:""},ignoreKeys=["account","contextData","linkTrackVars"];buffer.forEach(function(evt){Object.keys(evt).forEach(function(key){ignoreKeys.indexOf(key)===-1&&(props[key]=evt[key])}),angular.extend(bufferedProps.contextData,evt.contextData),bufferedProps.linkTrackVars+=","+evt.linkTrackVars}),window.s.tl(this,linkType,eventLabel,bufferedProps),buffer.length=0,buffer.timeout=null},1e3,1)):window.s.tl(this,linkType,eventLabel,props)}])}),$analyticsProvider.registerSetSuperProperties(function(props){$analyticsProvider.settings.adobeA.properties.global=props.global,$analyticsProvider.settings.adobeA.properties.eventClass=props.eventClass,$analyticsProvider.settings.adobeA.properties.eventMap=props.eventMap})}])}(window,window.angular);
//# sourceMappingURL=../dist/angulartics-adobe-analytics.min.js.map